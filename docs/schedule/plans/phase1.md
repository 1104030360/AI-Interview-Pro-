# Phase 1: æƒ…ç·’åˆ†æç³»çµ±é‡æ§‹è¨ˆç•«

**å°ˆæ¡ˆç›®æ¨™ï¼š** å°‡ç¾æœ‰çš„æƒ…ç·’åˆ†æç³»çµ±å¾ã€Œèƒ½ç”¨ã€æå‡åˆ°ã€Œå·¥ç¨‹ç´šå“è³ªã€

**è¨ˆç•«æœŸé–“ï¼š** 2025å¹´11æœˆ15æ—¥ - 2025å¹´12æœˆ15æ—¥

---

## ğŸ“‹ å¾…è¾¦æ¸…å–®ç¸½è¦½

### ğŸ”´ Critical - ç«‹å³ä¿®å¾©ï¼ˆç¬¬ä¸€é€±ï¼‰

**å„ªå…ˆç´šï¼šP0 - å¿…é ˆå®Œæˆï¼Œå¦å‰‡å°ˆæ¡ˆç„¡æ³•ç¶­è­·èˆ‡æ“´å±•**

#### 1. æ¶ˆé™¤ç¡¬ç·¨ç¢¼è·¯å¾‘ç½é›£

**å•é¡Œæè¿°ï¼š**
- æ‰€æœ‰æ¨¡å‹ã€å­—é«”è·¯å¾‘éƒ½ç¡¬ç·¨ç¢¼ç‚º `/Users/linjunting/Downloads/...`
- ç¨‹å¼ç¢¼å®Œå…¨ä¸å¯ç§»æ¤ï¼Œåªèƒ½åœ¨ç‰¹å®šé›»è…¦ä¸Šé‹è¡Œ
- é•ååŸºæœ¬çš„è»Ÿé«”å·¥ç¨‹åŸå‰‡

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å»ºç«‹å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹çš„ `.env.example` æª”æ¡ˆ
  - [ ] å®šç¾© `MODEL_DIR` ç’°å¢ƒè®Šæ•¸
  - [ ] å®šç¾© `FONT_DIR` ç’°å¢ƒè®Šæ•¸
  - [ ] å®šç¾© `OUTPUT_DIR` ç’°å¢ƒè®Šæ•¸
  - [ ] åŠ å…¥èªªæ˜æ–‡ä»¶
- [ ] å®‰è£ `python-dotenv` å¥—ä»¶
  ```bash
  pip install python-dotenv
  pip freeze > requirements.txt
  ```
- [ ] ä¿®æ”¹ `project.py:12-13` çš„æ¨¡å‹è¼‰å…¥é‚è¼¯
  - [ ] ä½¿ç”¨ `os.getenv()` è®€å–ç’°å¢ƒè®Šæ•¸
  - [ ] ä½¿ç”¨ `pathlib.Path` è™•ç†è·¯å¾‘
  - [ ] åŠ å…¥æª”æ¡ˆå­˜åœ¨æ€§æª¢æŸ¥
  - [ ] åŠ å…¥å‹å–„çš„éŒ¯èª¤è¨Šæ¯
- [ ] ä¿®æ”¹ `project.py:53` çš„å­—é«”è·¯å¾‘
  - [ ] å¾ç’°å¢ƒè®Šæ•¸è®€å–å­—é«”ç›®éŒ„
  - [ ] åŠ å…¥é è¨­å€¼æ©Ÿåˆ¶
- [ ] ä¿®æ”¹ `Auto_Switch.py:13-14, 25` çš„è·¯å¾‘
  - [ ] å¥—ç”¨ç›¸åŒçš„ç’°å¢ƒè®Šæ•¸é‚è¼¯
- [ ] å»ºç«‹ `config.py` æ¨¡çµ„
  - [ ] é›†ä¸­ç®¡ç†æ‰€æœ‰è·¯å¾‘é…ç½®
  - [ ] æä¾›è·¯å¾‘é©—è­‰å‡½å¼
  - [ ] åŠ å…¥ docstring èªªæ˜ç”¨é€”
- [ ] æ›´æ–° `README.md`
  - [ ] èªªæ˜å¦‚ä½•è¨­å®šç’°å¢ƒè®Šæ•¸
  - [ ] æä¾›ç¯„ä¾‹ `.env` æª”æ¡ˆå…§å®¹
  - [ ] åŠ å…¥æª”æ¡ˆçµæ§‹èªªæ˜

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… ç¨‹å¼å¯åœ¨ä¸åŒé›»è…¦ä¸Šé‹è¡Œï¼Œåªéœ€ä¿®æ”¹ `.env` æª”æ¡ˆ
- âœ… æ‰€æœ‰è·¯å¾‘é€éç’°å¢ƒè®Šæ•¸æˆ–è¨­å®šæª”ç®¡ç†
- âœ… æª”æ¡ˆä¸å­˜åœ¨æ™‚æœ‰æ¸…æ¥šçš„éŒ¯èª¤è¨Šæ¯

**é ä¼°æ™‚é–“ï¼š** 4 å°æ™‚

---

#### 2. é‡æ§‹è³‡æ–™çµæ§‹ - æ¶ˆé™¤ 18 å€‹å…¨åŸŸè®Šæ•¸

**å•é¡Œæè¿°ï¼š**
- `project.py:16-39` æœ‰ 18 å€‹å…¨åŸŸè®Šæ•¸
- å‘½åæ··äº‚ï¼š`class_1_detected1`, `start_time_11` ç­‰
- ç„¡æ³•æ“´å±•ï¼šå¢åŠ ç¬¬ä¸‰å€‹æ”å½±æ©Ÿéœ€è¦å†åŠ  18 å€‹è®Šæ•¸
- å®Œå…¨æ²’æœ‰å°è£

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å»ºç«‹ `models` ç›®éŒ„
- [ ] å»ºç«‹ `models/camera_state.py` æª”æ¡ˆ
  - [ ] å®šç¾© `CameraState` dataclass
    - [ ] `class_1_detected: bool`
    - [ ] `class_2_detected: bool`
    - [ ] `start_time_1: Optional[float]`
    - [ ] `start_time_2: Optional[float]`
    - [ ] `start_time_low_confidence: Optional[float]`
    - [ ] `ages_over_time: List[int]`
    - [ ] `genders_over_time: List[Tuple[str, float]]`
    - [ ] `emotions_over_time: List[str]`
    - [ ] `result_age: Optional[int]`
    - [ ] `result_gender: Optional[str]`
    - [ ] `result_gender_confidence: Optional[float]`
  - [ ] å¯¦ä½œ `__post_init__` æ–¹æ³•åˆå§‹åŒ–åˆ—è¡¨
  - [ ] åŠ å…¥å‹åˆ¥æç¤º
  - [ ] æ’°å¯« docstring
- [ ] åœ¨ `project.py` ä¸­ä½¿ç”¨ `CameraState`
  - [ ] å»ºç«‹ `camera_states` å­—å…¸
    ```python
    camera_states = {
        'customer': CameraState(),
        'server': CameraState()
    }
    ```
  - [ ] ç§»é™¤æ‰€æœ‰èˆŠçš„å…¨åŸŸè®Šæ•¸è²æ˜
  - [ ] æ›´æ–°æ‰€æœ‰å¼•ç”¨é€™äº›è®Šæ•¸çš„åœ°æ–¹
- [ ] æ›´æ–°è®Šæ•¸å‘½å
  - [ ] `class_1_detected` â†’ `customer_camera_state.class_1_detected`
  - [ ] `class_1_detected1` â†’ `server_camera_state.class_1_detected`
  - [ ] `start_time_11` â†’ `server_camera_state.start_time_1`
  - [ ] çµ±ä¸€ä½¿ç”¨ `camera_states['customer']` å’Œ `camera_states['server']`
- [ ] æ’°å¯«å–®å…ƒæ¸¬è©¦ `tests/test_camera_state.py`
  - [ ] æ¸¬è©¦åˆå§‹åŒ–
  - [ ] æ¸¬è©¦åˆ—è¡¨è‡ªå‹•å»ºç«‹
  - [ ] æ¸¬è©¦ç‹€æ…‹æ›´æ–°

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… æ‰€æœ‰å…¨åŸŸè®Šæ•¸è¢«å°è£é€² `CameraState` é¡åˆ¥
- âœ… ç¨‹å¼ç¢¼ä½¿ç”¨æ¸…æ™°çš„å­—å…¸çµæ§‹ç®¡ç†å¤šå€‹æ”å½±æ©Ÿ
- âœ… å¯è¼•é¬†æ“´å±•åˆ° 3+ å€‹æ”å½±æ©Ÿ
- âœ… å–®å…ƒæ¸¬è©¦é€šé

**é ä¼°æ™‚é–“ï¼š** 6 å°æ™‚

---

#### 3. æ¶ˆé™¤é‡è¤‡ç¨‹å¼ç¢¼

**å•é¡Œæè¿°ï¼š**
- `project.py:206-234` é›™æ”å½±æ©Ÿè™•ç†é‚è¼¯å®Œå…¨é‡è¤‡
- ä¿®æ”¹ bug éœ€è¦æ”¹å…©å€‹åœ°æ–¹
- é•å DRY (Don't Repeat Yourself) åŸå‰‡

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å»ºç«‹ `utils` ç›®éŒ„
- [ ] å»ºç«‹ `utils/camera_processing.py` æª”æ¡ˆ
  - [ ] å»ºç«‹ `process_camera_frame()` å‡½å¼
    ```python
    def process_camera_frame(
        frame, 
        class_name, 
        confidence_score,
        camera_state: CameraState, 
        check_time: float
    ) -> Dict
    ```
  - [ ] çµ±ä¸€è™•ç† `check_time <= 8` çš„é‚è¼¯
  - [ ] æ ¹æ“šæ™‚é–“é¸æ“‡èª¿ç”¨ `analyze_frame_A` æˆ– `analyze_frame_B`
  - [ ] æ›´æ–° `camera_state` çš„å±¬æ€§
  - [ ] åŠ å…¥å‹åˆ¥æç¤ºå’Œ docstring
- [ ] åœ¨ `project.py` ä¸»å¾ªç’°ä¸­ä½¿ç”¨çµ±ä¸€å‡½å¼
  - [ ] ç§»é™¤é‡è¤‡çš„ if-else å€å¡Š
  - [ ] ç‚ºå…©å€‹æ”å½±æ©Ÿèª¿ç”¨ç›¸åŒçš„å‡½å¼
    ```python
    result0 = process_camera_frame(
        frame, class_name, confidence_score,
        camera_states['customer'], check_time
    )
    result1 = process_camera_frame(
        frame1, class_name1, confidence_score1,
        camera_states['server'], check_time
    )
    ```
- [ ] é‡æ§‹ `analyze_frame_A` å’Œ `analyze_frame_B`
  - [ ] ç¢ºä¿åƒæ•¸ä¸€è‡´æ€§
  - [ ] åŠ å…¥å‹åˆ¥æç¤º
  - [ ] æ”¹é€²å‡½å¼å‘½åï¼ˆæ”¹ç‚ºæ›´æœ‰æ„ç¾©çš„åç¨±ï¼‰
- [ ] æ’°å¯«å–®å…ƒæ¸¬è©¦ `tests/test_camera_processing.py`
  - [ ] æ¸¬è©¦çŸ­æ™‚é–“æƒ…å¢ƒï¼ˆ<= 8 ç§’ï¼‰
  - [ ] æ¸¬è©¦é•·æ™‚é–“æƒ…å¢ƒï¼ˆ> 8 ç§’ï¼‰
  - [ ] æ¸¬è©¦ç‹€æ…‹æ›´æ–°

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… æ”å½±æ©Ÿè™•ç†é‚è¼¯åªå¯«ä¸€æ¬¡
- âœ… ç¨‹å¼ç¢¼è¡Œæ•¸æ¸›å°‘è‡³å°‘ 50 è¡Œ
- âœ… ä»»ä½•ä¿®æ”¹åªéœ€è¦æ”¹ä¸€å€‹åœ°æ–¹
- âœ… å–®å…ƒæ¸¬è©¦è¦†è“‹ç‡ > 80%

**é ä¼°æ™‚é–“ï¼š** 5 å°æ™‚

---

#### 4. åŠ å…¥é©ç•¶éŒ¯èª¤è™•ç†

**å•é¡Œæè¿°ï¼š**
- ä½¿ç”¨ `except Exception` æ•æ‰æ‰€æœ‰ä¾‹å¤–
- éŒ¯èª¤ç™¼ç”Ÿå¾Œåªå°è¨Šæ¯ï¼Œæ²’æœ‰é‡è©¦æˆ–é™ç´šç­–ç•¥
- æ”å½±æ©Ÿé–‹å•Ÿå¤±æ•—æ²’æœ‰æª¢æŸ¥
- ä½¿ç”¨è€…ç„¡æ³•çŸ¥é“å•é¡Œå‡ºåœ¨å“ªè£¡

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å»ºç«‹ `exceptions.py` è‡ªè¨‚ä¾‹å¤–é¡åˆ¥
  - [ ] `CameraError` - æ”å½±æ©Ÿç›¸é—œéŒ¯èª¤
  - [ ] `ModelLoadError` - æ¨¡å‹è¼‰å…¥éŒ¯èª¤
  - [ ] `AnalysisError` - åˆ†æå¤±æ•—éŒ¯èª¤
  - [ ] æ¯å€‹ä¾‹å¤–åŠ å…¥æ¸…æ¥šçš„èªªæ˜
- [ ] é‡æ§‹æ”å½±æ©Ÿé–‹å•Ÿé‚è¼¯
  - [ ] å»ºç«‹ `open_camera_with_retry()` å‡½å¼
  - [ ] æœ€å¤šé‡è©¦ 3 æ¬¡
  - [ ] æ¯æ¬¡é‡è©¦é–“éš” 1 ç§’
  - [ ] å¤±æ•—æ™‚æ‹‹å‡º `CameraError` ä¸¦èªªæ˜åŸå› 
  - [ ] åŠ å…¥æ—¥èªŒè¨˜éŒ„æ¯æ¬¡å˜—è©¦
- [ ] é‡æ§‹æ¨¡å‹è¼‰å…¥é‚è¼¯
  - [ ] ä½¿ç”¨ try-except æ•æ‰è¼‰å…¥å¤±æ•—
  - [ ] æª¢æŸ¥æª”æ¡ˆæ˜¯å¦å­˜åœ¨
  - [ ] æ‹‹å‡º `ModelLoadError` ä¸¦æä¾›å»ºè­°
- [ ] é‡æ§‹ DeepFace åˆ†æé‚è¼¯
  - [ ] å»ºç«‹ `analyze_frame_with_retry()` å‡½å¼
  - [ ] å€åˆ†ã€Œæ²’æœ‰åµæ¸¬åˆ°è‡‰ã€ï¼ˆæ­£å¸¸ï¼‰å’Œã€Œåˆ†æå¤±æ•—ã€ï¼ˆéŒ¯èª¤ï¼‰
  - [ ] `ValueError` â†’ æ­£å¸¸æƒ…æ³ï¼Œå›å‚³ None
  - [ ] å…¶ä»–ä¾‹å¤– â†’ æœ€å¤šé‡è©¦ 2 æ¬¡
  - [ ] è¨˜éŒ„éŒ¯èª¤æ—¥èªŒ
- [ ] åœ¨ä¸»ç¨‹å¼åŠ å…¥ try-finally ç¢ºä¿è³‡æºé‡‹æ”¾
  - [ ] ç¢ºä¿æ”å½±æ©Ÿç¸½æ˜¯è¢«æ­£ç¢ºé—œé–‰
  - [ ] ç¢ºä¿è¦–è¨Šå¯«å…¥å™¨è¢«æ­£ç¢ºé—œé–‰
- [ ] æ’°å¯«éŒ¯èª¤è™•ç†æ¸¬è©¦
  - [ ] æ¸¬è©¦æ”å½±æ©Ÿé–‹å•Ÿå¤±æ•—æƒ…å¢ƒ
  - [ ] æ¸¬è©¦æ¨¡å‹è¼‰å…¥å¤±æ•—æƒ…å¢ƒ
  - [ ] æ¸¬è©¦åˆ†æé‡è©¦æ©Ÿåˆ¶

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… æ‰€æœ‰éŒ¯èª¤æœ‰æ¸…æ¥šçš„éŒ¯èª¤è¨Šæ¯å’Œå»ºè­°
- âœ… æš«æ™‚æ€§éŒ¯èª¤æœƒè‡ªå‹•é‡è©¦
- âœ… é—œéµè³‡æºï¼ˆæ”å½±æ©Ÿã€æª”æ¡ˆï¼‰ç¸½æ˜¯è¢«æ­£ç¢ºé‡‹æ”¾
- âœ… éŒ¯èª¤è™•ç†æ¸¬è©¦é€šé

**é ä¼°æ™‚é–“ï¼š** 6 å°æ™‚

---

### ğŸŸ¡ Important - è¿‘æœŸæ”¹é€²ï¼ˆç¬¬äºŒé€±ï¼‰

**å„ªå…ˆç´šï¼šP1 - é‡è¦ï¼Œé¡¯è‘—æ”¹å–„ç¨‹å¼ç¢¼å“è³ª**

#### 5. æ‹†åˆ†å·¨å‹ä¸»å¾ªç’°

**å•é¡Œæè¿°ï¼š**
- `project.py:166-260` ä¸»å¾ªç’°è¶…é 100 è¡Œ
- åµŒå¥— 4-5 å±¤æ·±åº¦
- åŒæ™‚è™•ç†ï¼šç•«é¢æ“·å–ã€åˆ†é¡ã€åˆ†æã€é¡¯ç¤ºã€éŒ„å½±
- é•åå–®ä¸€è·è²¬åŸå‰‡ï¼Œç„¡æ³•æ¸¬è©¦

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å»ºç«‹ `utils/frame_capture.py`
  - [ ] `capture_frames(cameras: Dict) -> Dict[str, np.ndarray]`
  - [ ] è™•ç†æ‰€æœ‰æ”å½±æ©Ÿçš„ç•«é¢è®€å–
  - [ ] è™•ç†è®€å–å¤±æ•—æƒ…æ³
- [ ] å»ºç«‹ `utils/classification.py`
  - [ ] `classify_frame(frame, model, class_names) -> Tuple[str, float]`
  - [ ] å°è£é è™•ç†é‚è¼¯
  - [ ] å°è£é æ¸¬é‚è¼¯
- [ ] å»ºç«‹ `utils/display.py`
  - [ ] `update_display(frames: Dict, results: Dict, font)`
  - [ ] çµ±ä¸€è™•ç†ç•«é¢é¡¯ç¤º
  - [ ] ç¹ªè£½æ–‡å­—ã€é‚Šæ¡†ç­‰
- [ ] å»ºç«‹ `utils/recording.py`
  - [ ] `record_frames(video_writers: Dict, frames: Dict)`
  - [ ] è™•ç†è¦–è¨ŠéŒ„è£½
- [ ] å»ºç«‹ `utils/exit_conditions.py`
  - [ ] `should_exit(camera_states: Dict, results: Dict) -> bool`
  - [ ] çµ±ä¸€åˆ¤æ–·æ˜¯å¦æ‡‰è©²çµæŸç¨‹å¼
- [ ] é‡æ§‹ä¸»å¾ªç’°
  ```python
  def main_loop(cameras, model, config):
      while True:
          frames = capture_frames(cameras)
          if not frames:
              break
          
          results = {}
          for cam_id, frame in frames.items():
              results[cam_id] = process_single_camera(
                  frame, model, camera_states[cam_id], config
              )
          
          update_display(frames, results)
          record_frames(video_writers, frames)
          
          if should_exit(camera_states, results):
              break
  ```
- [ ] ç‚ºæ¯å€‹æ–°å‡½å¼æ’°å¯«æ¸¬è©¦

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… ä¸»å¾ªç’° < 30 è¡Œ
- âœ… æ¯å€‹å‡½å¼åªåšä¸€ä»¶äº‹
- âœ… åµŒå¥—æ·±åº¦ <= 2 å±¤
- âœ… æ‰€æœ‰å‡½å¼éƒ½å¯ç¨ç«‹æ¸¬è©¦
- âœ… æ¸¬è©¦è¦†è“‹ç‡ > 70%

**é ä¼°æ™‚é–“ï¼š** 8 å°æ™‚

---

#### 6. æ¶ˆé™¤é­”è¡“æ•¸å­—

**å•é¡Œæè¿°ï¼š**
- ç¨‹å¼ç¢¼ä¸­å……æ»¿æœªå‘½åçš„æ•¸å­—ï¼š3, 8, 60, 100 ç­‰
- ç„¡æ³•ç†è§£é€™äº›æ•¸å­—çš„æ„ç¾©
- ä¿®æ”¹éœ€è¦æœå°‹æ‰€æœ‰å‡ºç¾çš„åœ°æ–¹

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å»ºç«‹ `config.py` è¨­å®šé¡åˆ¥
  ```python
  class EmotionAnalysisConfig:
      # Detection timing
      PRESENCE_DETECTION_DELAY_SEC = 3
      ABSENCE_DETECTION_DELAY_SEC = 3
      LOW_CONFIDENCE_TIMEOUT_SEC = 3
      
      # Analysis duration
      DEMOGRAPHIC_ANALYSIS_DURATION_SEC = 8
      
      # Scoring
      BASELINE_SCORE = 60
      EMOTION_WEIGHT_RANGE = 40
      
      # Camera settings
      TARGET_FPS = 5
      CAMERA_WIDTH = 320
      CAMERA_HEIGHT = 240
      
      # Emotion weights
      EMOTION_WEIGHTS = {
          'positive': 1,
          'neutral': 0,
          'negative': -1
      }
  ```
- [ ] ç‚ºæ¯å€‹å¸¸æ•¸åŠ å…¥è¨»è§£èªªæ˜ç”¨é€”
- [ ] æ›¿æ› `project.py` ä¸­æ‰€æœ‰é­”è¡“æ•¸å­—
  - [ ] `3` â†’ `Config.PRESENCE_DETECTION_DELAY_SEC`
  - [ ] `8` â†’ `Config.DEMOGRAPHIC_ANALYSIS_DURATION_SEC`
  - [ ] `60` â†’ `Config.BASELINE_SCORE`
  - [ ] æ‰€æœ‰æƒ…ç·’æ¬Šé‡ä½¿ç”¨ `Config.EMOTION_WEIGHTS`
- [ ] æ›¿æ› `Auto_Switch.py` ä¸­çš„é­”è¡“æ•¸å­—
- [ ] å…è¨±å¾è¨­å®šæª”è¦†å¯«é è¨­å€¼
  - [ ] æ”¯æ´ JSON æˆ– YAML è¨­å®šæª”
  - [ ] è¨­å®šæª”è·¯å¾‘å¾ç’°å¢ƒè®Šæ•¸è®€å–
- [ ] æ›´æ–°æ–‡ä»¶èªªæ˜æ¯å€‹è¨­å®šçš„æ„ç¾©

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… ç¨‹å¼ç¢¼ä¸­æ²’æœ‰æœªå‘½åçš„æ•¸å­—
- âœ… æ‰€æœ‰è¨­å®šé›†ä¸­åœ¨ `config.py`
- âœ… å¯é€éè¨­å®šæª”èª¿æ•´åƒæ•¸
- âœ… æ–‡ä»¶æ¸…æ¥šèªªæ˜æ¯å€‹åƒæ•¸

**é ä¼°æ™‚é–“ï¼š** 4 å°æ™‚

---

#### 7. æ”¹å–„è®Šæ•¸å‘½å

**å•é¡Œæè¿°ï¼š**
- å‘½åä¸ä¸€è‡´ï¼š`cam0scr` vs `camera_states`
- å‘½åä¸æ¸…æ™°ï¼š`class_1_detected1`, `start_time_11`
- ç„¡æ³•å¾åç¨±ç†è§£è®Šæ•¸ç”¨é€”

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å»ºç«‹å‘½åè¦ç¯„æ–‡ä»¶ `docs/NAMING_CONVENTIONS.md`
  - [ ] é¡åˆ¥ï¼šPascalCase
  - [ ] å‡½å¼/è®Šæ•¸ï¼šsnake_case
  - [ ] å¸¸æ•¸ï¼šUPPER_SNAKE_CASE
  - [ ] å¸ƒæ—å€¼ï¼š`is_`, `has_`, `should_` å‰ç¶´
  - [ ] æ™‚é–“ï¼š`_time`, `_timestamp`, `_duration` å¾Œç¶´
- [ ] é‡æ–°å‘½åä¸»è¦è®Šæ•¸
  - [ ] `class_1_detected` â†’ `person_detected`
  - [ ] `class_2_detected` â†’ `no_person_detected`
  - [ ] `start_time_1` â†’ `person_detection_start_time`
  - [ ] `start_time_2` â†’ `no_person_detection_start_time`
  - [ ] `start_time_low_confidence` â†’ `low_confidence_start_time`
  - [ ] `cam0scr` â†’ `customer_emotion_score`
  - [ ] `cam1scr` â†’ `server_emotion_score`
- [ ] é‡æ–°å‘½åå‡½å¼
  - [ ] `analyze_frame_A` â†’ `analyze_with_demographics`
  - [ ] `analyze_frame_B` â†’ `analyze_emotions_only`
- [ ] ç¢ºä¿è®Šæ•¸åç¨±æœ‰æ„ç¾©ä¸”ä¸€è‡´
- [ ] ä½¿ç”¨ IDE é‡æ§‹åŠŸèƒ½æ‰¹é‡é‡æ–°å‘½å

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… æ‰€æœ‰è®Šæ•¸åç¨±æ¸…æ™°è¡¨é”ç”¨é€”
- âœ… å‘½åéµå¾ªä¸€è‡´çš„è¦ç¯„
- âœ… æ–°æ‰‹å¯ä»¥å¾åç¨±ç†è§£ç¨‹å¼é‚è¼¯
- âœ… æ²’æœ‰æ•¸å­—å¾Œç¶´ï¼ˆ`1`, `11` ç­‰ï¼‰

**é ä¼°æ™‚é–“ï¼š** 3 å°æ™‚

---

#### 8. åŠ å…¥æ—¥èªŒç³»çµ±

**å•é¡Œæè¿°ï¼š**
- æ‰€æœ‰è¨Šæ¯è¼¸å‡ºä½¿ç”¨ `print()`
- ç„¡æ³•æ§åˆ¶æ—¥èªŒç­‰ç´š
- ç„¡æ³•è¨˜éŒ„åˆ°æª”æ¡ˆ
- ç”Ÿç”¢ç’°å¢ƒç„¡æ³•ä½¿ç”¨

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å»ºç«‹ `utils/logging_config.py`
  ```python
  import logging
  from pathlib import Path
  
  def setup_logging(log_level='INFO', log_dir='./logs'):
      log_dir = Path(log_dir)
      log_dir.mkdir(exist_ok=True)
      
      logging.basicConfig(
          level=log_level,
          format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
          handlers=[
              logging.FileHandler(log_dir / 'emotion_analysis.log'),
              logging.StreamHandler()
          ]
      )
  ```
- [ ] åœ¨æ¯å€‹æ¨¡çµ„å»ºç«‹ logger
  ```python
  import logging
  logger = logging.getLogger(__name__)
  ```
- [ ] æ›¿æ›æ‰€æœ‰ `print()` ç‚ºé©ç•¶çš„æ—¥èªŒç­‰ç´š
  - [ ] ä¸€èˆ¬è³‡è¨Š â†’ `logger.info()`
  - [ ] è­¦å‘Šè¨Šæ¯ â†’ `logger.warning()`
  - [ ] éŒ¯èª¤è¨Šæ¯ â†’ `logger.error()`
  - [ ] é™¤éŒ¯è³‡è¨Š â†’ `logger.debug()`
- [ ] åœ¨ä¸»ç¨‹å¼åˆå§‹åŒ–æ—¥èªŒç³»çµ±
  ```python
  if __name__ == '__main__':
      setup_logging(
          log_level=os.getenv('LOG_LEVEL', 'INFO'),
          log_dir=os.getenv('LOG_DIR', './logs')
      )
  ```
- [ ] åŠ å…¥æ—¥èªŒè¼ªæ›¿æ©Ÿåˆ¶
  - [ ] ä½¿ç”¨ `RotatingFileHandler`
  - [ ] è¨­å®šæœ€å¤§æª”æ¡ˆå¤§å°
  - [ ] ä¿ç•™æœ€è¿‘ 5 å€‹æ—¥èªŒæª”
- [ ] æ›´æ–° `.gitignore` å¿½ç•¥æ—¥èªŒæª”æ¡ˆ
  ```
  logs/
  *.log
  ```

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… æ²’æœ‰ä»»ä½• `print()` èªå¥ï¼ˆé™¤äº†æ¸¬è©¦ï¼‰
- âœ… æ—¥èªŒå¯«å…¥æª”æ¡ˆå’Œçµ‚ç«¯
- âœ… å¯é€éç’°å¢ƒè®Šæ•¸æ§åˆ¶æ—¥èªŒç­‰ç´š
- âœ… æ—¥èªŒåŒ…å«æ™‚é–“æˆ³è¨˜å’Œæ¨¡çµ„åç¨±

**é ä¼°æ™‚é–“ï¼š** 3 å°æ™‚

---

### ğŸŸ¢ Enhancement - é•·æœŸæ”¹å–„ï¼ˆç¬¬ä¸‰-å››é€±ï¼‰

**å„ªå…ˆç´šï¼šP2 - æå‡å“è³ªå’Œå¯ç¶­è­·æ€§**

#### 9. æ’°å¯«å–®å…ƒæ¸¬è©¦

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å»ºç«‹æ¸¬è©¦æ¡†æ¶
  - [ ] å®‰è£ pytest: `pip install pytest pytest-cov`
  - [ ] å»ºç«‹ `tests/` ç›®éŒ„
  - [ ] å»ºç«‹ `tests/conftest.py` è¨­å®š fixtures
  - [ ] å»ºç«‹ `pytest.ini` è¨­å®šæª”
- [ ] æ’°å¯«æ ¸å¿ƒæ¨¡çµ„æ¸¬è©¦
  - [ ] `tests/test_camera_state.py` - æ¸¬è©¦ç‹€æ…‹ç®¡ç†
  - [ ] `tests/test_config.py` - æ¸¬è©¦è¨­å®šè¼‰å…¥
  - [ ] `tests/test_camera_processing.py` - æ¸¬è©¦è™•ç†é‚è¼¯
  - [ ] `tests/test_classification.py` - æ¸¬è©¦åˆ†é¡åŠŸèƒ½
  - [ ] `tests/test_emotion_scoring.py` - æ¸¬è©¦è©•åˆ†è¨ˆç®—
- [ ] å»ºç«‹æ¨¡æ“¬ç‰©ä»¶
  - [ ] Mock æ”å½±æ©Ÿè¼¸å…¥
  - [ ] Mock DeepFace API å›æ‡‰
  - [ ] Mock Keras æ¨¡å‹é æ¸¬
- [ ] è¨­å®š CI/CD
  - [ ] å»ºç«‹ `.github/workflows/tests.yml`
  - [ ] æ¯æ¬¡ push è‡ªå‹•åŸ·è¡Œæ¸¬è©¦
  - [ ] ç”¢ç”Ÿè¦†è“‹ç‡å ±å‘Š
- [ ] é”æˆæ¸¬è©¦è¦†è“‹ç‡ç›®æ¨™
  - [ ] æ ¸å¿ƒé‚è¼¯ > 80%
  - [ ] æ•´é«”å°ˆæ¡ˆ > 60%

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… æ¸¬è©¦è¦†è“‹ç‡ >= 60%
- âœ… æ‰€æœ‰æ¸¬è©¦é€šé
- âœ… CI/CD è‡ªå‹•åŸ·è¡Œæ¸¬è©¦
- âœ… å¯ç”¨ `pytest` å‘½ä»¤åŸ·è¡Œæ‰€æœ‰æ¸¬è©¦

**é ä¼°æ™‚é–“ï¼š** 12 å°æ™‚

---

#### 10. åŠ å…¥å‹åˆ¥æç¤º

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] å®‰è£ mypy: `pip install mypy`
- [ ] ç‚ºæ‰€æœ‰å‡½å¼åŠ å…¥å‹åˆ¥æç¤º
  - [ ] åƒæ•¸å‹åˆ¥
  - [ ] å›å‚³å€¼å‹åˆ¥
  - [ ] ä½¿ç”¨ `Optional`, `Union`, `List`, `Dict` ç­‰
- [ ] ç‚ºé¡åˆ¥å±¬æ€§åŠ å…¥å‹åˆ¥æç¤º
- [ ] å»ºç«‹ `mypy.ini` è¨­å®šæª”
  ```ini
  [mypy]
  python_version = 3.8
  warn_return_any = True
  warn_unused_configs = True
  disallow_untyped_defs = True
  ```
- [ ] åŸ·è¡Œ mypy æª¢æŸ¥
  ```bash
  mypy project.py utils/ models/
  ```
- [ ] ä¿®å¾©æ‰€æœ‰å‹åˆ¥éŒ¯èª¤
- [ ] åŠ å…¥ mypy åˆ° CI/CD

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… æ‰€æœ‰å…¬é–‹å‡½å¼æœ‰å‹åˆ¥æç¤º
- âœ… mypy æª¢æŸ¥ç„¡éŒ¯èª¤
- âœ… IDE å¯æä¾›æ›´å¥½çš„è‡ªå‹•å®Œæˆ

**é ä¼°æ™‚é–“ï¼š** 6 å°æ™‚

---

#### 11. æ•ˆèƒ½å„ªåŒ–

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] åˆ†ææ•ˆèƒ½ç“¶é ¸
  - [ ] ä½¿ç”¨ `cProfile` åˆ†æ
  - [ ] ä½¿ç”¨ `line_profiler` æ‰¾å‡ºæ…¢çš„ç¨‹å¼ç¢¼
- [ ] å„ªåŒ– DeepFace èª¿ç”¨
  - [ ] å¿«å–äººå£çµ±è¨ˆè³‡è¨Šï¼ˆå¹´é½¡ã€æ€§åˆ¥ï¼‰
  - [ ] åªåœ¨å¿…è¦æ™‚åˆ†ææƒ…ç·’
  - [ ] è€ƒæ…®ä½¿ç”¨æ›´å¿«çš„æ¨¡å‹
- [ ] å„ªåŒ–å½±åƒè™•ç†
  - [ ] é¿å…é‡è¤‡çš„ resize æ“ä½œ
  - [ ] è€ƒæ…®ä½¿ç”¨ GPU åŠ é€Ÿ
- [ ] å„ªåŒ–è¨˜æ†¶é«”ä½¿ç”¨
  - [ ] é™åˆ¶ `emotions_over_time` ç­‰åˆ—è¡¨å¤§å°
  - [ ] åŠæ™‚é‡‹æ”¾ä¸éœ€è¦çš„ç•«é¢
- [ ] åŠ å…¥æ•ˆèƒ½ç›£æ§
  - [ ] è¨˜éŒ„æ¯å¹€è™•ç†æ™‚é–“
  - [ ] è¨˜éŒ„ FPS
  - [ ] åŠ å…¥æ•ˆèƒ½è­¦å‘Š

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… FPS æå‡ 20% ä»¥ä¸Š
- âœ… è¨˜æ†¶é«”ä½¿ç”¨ç©©å®š
- âœ… æœ‰æ•ˆèƒ½ç›£æ§æŒ‡æ¨™

**é ä¼°æ™‚é–“ï¼š** 8 å°æ™‚

---

#### 12. æ–‡ä»¶åŒ–

**ä»»å‹™æ¸…å–®ï¼š**
- [ ] æ’°å¯« docstrings
  - [ ] æ‰€æœ‰å…¬é–‹å‡½å¼
  - [ ] æ‰€æœ‰é¡åˆ¥
  - [ ] ä½¿ç”¨ Google æˆ– NumPy é¢¨æ ¼
- [ ] æ›´æ–° `README.md`
  - [ ] å°ˆæ¡ˆç°¡ä»‹
  - [ ] å®‰è£èªªæ˜
  - [ ] ç’°å¢ƒè®Šæ•¸è¨­å®š
  - [ ] ä½¿ç”¨ç¯„ä¾‹
  - [ ] å¸¸è¦‹å•é¡Œ
- [ ] å»ºç«‹ `docs/` æ–‡ä»¶
  - [ ] `docs/SETUP.md` - è©³ç´°è¨­å®šæŒ‡å—
  - [ ] `docs/ARCHITECTURE.md` - æ¶æ§‹èªªæ˜
  - [ ] `docs/API.md` - API æ–‡ä»¶
  - [ ] `docs/CONTRIBUTING.md` - è²¢ç»æŒ‡å—
- [ ] ç”¢ç”Ÿ API æ–‡ä»¶
  - [ ] ä½¿ç”¨ Sphinx æˆ– pdoc
  - [ ] è‡ªå‹•å¾ docstrings ç”Ÿæˆ
- [ ] åŠ å…¥ç¨‹å¼ç¢¼ç¯„ä¾‹
  - [ ] åŸºæœ¬ä½¿ç”¨ç¯„ä¾‹
  - [ ] é€²éšè¨­å®šç¯„ä¾‹

**é©—æ”¶æ¨™æº–ï¼š**
- âœ… æ‰€æœ‰å…¬é–‹å‡½å¼æœ‰ docstring
- âœ… README æ¸…æ¥šèªªæ˜å¦‚ä½•ä½¿ç”¨
- âœ… æœ‰å®Œæ•´çš„ API æ–‡ä»¶
- âœ… æ–°æ‰‹å¯ä¾æ–‡ä»¶æˆåŠŸåŸ·è¡Œ

**é ä¼°æ™‚é–“ï¼š** 6 å°æ™‚

---

## ğŸ“Š é€²åº¦è¿½è¹¤

### ç¬¬ä¸€é€±ï¼ˆ11/15 - 11/21ï¼‰
- [ ] ä»»å‹™ 1: æ¶ˆé™¤ç¡¬ç·¨ç¢¼è·¯å¾‘
- [ ] ä»»å‹™ 2: é‡æ§‹è³‡æ–™çµæ§‹
- [ ] ä»»å‹™ 3: æ¶ˆé™¤é‡è¤‡ç¨‹å¼ç¢¼
- [ ] ä»»å‹™ 4: åŠ å…¥éŒ¯èª¤è™•ç†

**ç›®æ¨™ï¼š** è§£æ±ºæ‰€æœ‰ ğŸ”´ Critical å•é¡Œ

### ç¬¬äºŒé€±ï¼ˆ11/22 - 11/28ï¼‰
- [ ] ä»»å‹™ 5: æ‹†åˆ†å·¨å‹ä¸»å¾ªç’°
- [ ] ä»»å‹™ 6: æ¶ˆé™¤é­”è¡“æ•¸å­—
- [ ] ä»»å‹™ 7: æ”¹å–„è®Šæ•¸å‘½å
- [ ] ä»»å‹™ 8: åŠ å…¥æ—¥èªŒç³»çµ±

**ç›®æ¨™ï¼š** å®Œæˆæ‰€æœ‰ ğŸŸ¡ Important æ”¹é€²

### ç¬¬ä¸‰é€±ï¼ˆ11/29 - 12/05ï¼‰
- [ ] ä»»å‹™ 9: æ’°å¯«å–®å…ƒæ¸¬è©¦ï¼ˆ60% å®Œæˆï¼‰
- [ ] ä»»å‹™ 10: åŠ å…¥å‹åˆ¥æç¤º
- [ ] é–‹å§‹ä»»å‹™ 11: æ•ˆèƒ½å„ªåŒ–

**ç›®æ¨™ï¼š** å»ºç«‹æ¸¬è©¦æ¡†æ¶ï¼Œæå‡ç¨‹å¼ç¢¼å“è³ª

### ç¬¬å››é€±ï¼ˆ12/06 - 12/12ï¼‰
- [ ] å®Œæˆä»»å‹™ 9: å–®å…ƒæ¸¬è©¦ï¼ˆ100%ï¼‰
- [ ] å®Œæˆä»»å‹™ 11: æ•ˆèƒ½å„ªåŒ–
- [ ] ä»»å‹™ 12: å®Œæ•´æ–‡ä»¶åŒ–

**ç›®æ¨™ï¼š** é”æˆå¯ç™¼å¸ƒçš„å“è³ªæ¨™æº–

### æœ€çµ‚é€±ï¼ˆ12/13 - 12/15ï¼‰
- [ ] æ•´åˆæ¸¬è©¦
- [ ] ç¨‹å¼ç¢¼å¯©æŸ¥
- [ ] æ•ˆèƒ½é©—è­‰
- [ ] æ–‡ä»¶æ ¡å°
- [ ] æº–å‚™å±•ç¤º

---

## ğŸ¯ æˆåŠŸæŒ‡æ¨™

### ç¨‹å¼ç¢¼å“è³ª
- âœ… æ¸¬è©¦è¦†è“‹ç‡ >= 60%
- âœ… Mypy å‹åˆ¥æª¢æŸ¥ç„¡éŒ¯èª¤
- âœ… æ‰€æœ‰å‡½å¼ < 50 è¡Œ
- âœ… ä¸»å¾ªç’° < 30 è¡Œ
- âœ… åµŒå¥—æ·±åº¦ <= 2 å±¤
- âœ… é›¶å…¨åŸŸè®Šæ•¸

### å¯ç¶­è­·æ€§
- âœ… å¯åœ¨ä»»ä½•é›»è…¦ä¸ŠåŸ·è¡Œï¼ˆé€éç’°å¢ƒè®Šæ•¸è¨­å®šï¼‰
- âœ… æ–°å¢æ”å½±æ©Ÿåªéœ€åŠ ä¸€è¡Œç¨‹å¼ç¢¼
- âœ… ä¿®æ”¹é‚è¼¯åªéœ€æ”¹ä¸€å€‹åœ°æ–¹
- âœ… æ¸…æ¥šçš„éŒ¯èª¤è¨Šæ¯
- âœ… å®Œæ•´çš„æ—¥èªŒè¨˜éŒ„

### æ–‡ä»¶å®Œæ•´æ€§
- âœ… README èªªæ˜å¦‚ä½•å®‰è£å’Œä½¿ç”¨
- âœ… æ‰€æœ‰å…¬é–‹ API æœ‰ docstring
- âœ… æ¶æ§‹æ–‡ä»¶èªªæ˜è¨­è¨ˆæ±ºç­–
- âœ… æœ‰ç¨‹å¼ç¢¼ç¯„ä¾‹

### æ•ˆèƒ½
- âœ… FPS ç¶­æŒæˆ–æå‡
- âœ… è¨˜æ†¶é«”ä½¿ç”¨ç©©å®š
- âœ… å•Ÿå‹•æ™‚é–“ < 5 ç§’

---

## ğŸ“ æ³¨æ„äº‹é …

1. **æ¯å®Œæˆä¸€å€‹ä»»å‹™å°± commit**
   - ä½¿ç”¨æ¸…æ¥šçš„ commit message
   - éµå¾ª [Conventional Commits](https://www.conventionalcommits.org/)
   - ç¯„ä¾‹ï¼š`refactor: replace global variables with CameraState class`

2. **ä¿æŒå‘å¾Œç›¸å®¹**
   - é‡æ§‹æ™‚ç¢ºä¿åŠŸèƒ½ä¸è®Š
   - æœ‰ç–‘å•æ™‚å…ˆå¯«æ¸¬è©¦
   - é€æ­¥é‡æ§‹ï¼Œä¸è¦ä¸€æ¬¡æ”¹å¤ªå¤š

3. **å°‹æ±‚åé¥‹**
   - å®Œæˆé‡è¦ä»»å‹™å¾Œè«‹åœ˜éšŠå¯©æŸ¥
   - ä¸ç¢ºå®šæ™‚å…ˆè¨è«–å†å¯¦ä½œ
   - è¨˜éŒ„é‡è¦çš„è¨­è¨ˆæ±ºç­–

4. **æŒçºŒæ•´åˆ**
   - ç¢ºä¿æ¯æ¬¡ commit éƒ½èƒ½é€šéæ¸¬è©¦
   - ä¿®å¾© CI/CD å¤±æ•—è¦å„ªå…ˆè™•ç†
   - ä¿æŒ main branch æ°¸é å¯ç”¨

---

## ğŸ”— ç›¸é—œæ–‡ä»¶

- [ç¨‹å¼ç¢¼å¯©æŸ¥å ±å‘Š](../../CODE_REVIEW_IMPROVEMENTS.md)
- [å°ˆæ¡ˆ README](../../README.md)
- [æ¶æ§‹æ–‡ä»¶](../architecture/)
- [é–‹ç™¼æŒ‡å—](../dev-prompt/)

---

## ğŸ’¬ å•é¡Œèˆ‡è¨è«–

å¦‚æœ‰ä»»ä½•å•é¡Œæˆ–å»ºè­°ï¼Œè«‹åœ¨åœ˜éšŠæœƒè­°ä¸­æå‡ºï¼Œæˆ–åœ¨å°ˆæ¡ˆ Issues ä¸­è¨è«–ã€‚

**Let's make this code great! ğŸš€**
